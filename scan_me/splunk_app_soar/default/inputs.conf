# Copyright (C) 2023-2024 Splunk Inc. All Rights Reserved.
# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/splunk_app_soar/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/splunk_app_soar/default
# into ../local and edit there and save it as inputs.conf.
#

#### Splunk App for SOAR - used for SOAR System Logs and ITSI integration ####
# This add-on requires the Splunk-SOAR instance configured to use JSON as the log format.
# To enable the JSON log format, run the following command on the Splunk-SOAR CLI:
# sudo phenv set_preference --logging-format json
# If this add-on is installed onto a root-install (Priviledged) version of Splunk SOAR, then the logs directory location should be changed from ///opt/phantom/var/log/phantom to ///var/log/phantom

# Phantom Daemon Logs
[monitor:///opt/phantom/var/log/phantom/ingestd.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/decided.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/workflowd.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/actiond.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/wsgi.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
#sourcetype = splunk_app_soar:wsgi
disabled = false

[monitor:///opt/phantom/var/log/phantom/watchdogd.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/proxyd.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

[monitor:///opt/phantom/var/log/phantom/spawn.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:daemon
disabled = false

############################################################################
# Postgres - log location is the same regardless of Splunk-SOAR type
[monitor:///opt/phantom/data/db/pg_log/*]
index = splunk_app_soar
sourcetype = splunk_app_soar:postgres
disabled = false

############################################################################
# nginx web server - use nginx app on splunkbase for parsing https://splunkbase.splunk.com/app/3258/
[monitor:///opt/phantom/var/log/nginx/access.log]
index = splunk_app_soar
sourcetype = nginx:plus:access
disabled = false

[monitor:///opt/phantom/var/log/nginx/error.log]
index = splunk_app_soar
sourcetype = nginx:plus:error
disabled = false

############################################################################
# Auditd - use TA-auditd for parsing https://splunkbase.splunk.com/app/4232/
[monitor:///var/log/audit/audit.log]
index = splunk_app_soar
sourcetype = linux:audit
disabled = false

############################################################################
#Log files other than Daemon

[monitor:///opt/phantom/var/log/phantom/*log] #some files have no file types defined
index = splunk_app_soar
sourcetype = splunk_app_soar:misc-logs
blacklist = (spawnd\.log|actiond\.log|decided\.log|ingestd\.log|watchdogd\.log|workflowd\.log|wsgi\.log|proxyd\.log|clusterd\.log)
disabled = false

############################################################################
# Cluster only
[monitor:///opt/phantom/var/log/phantom/clusterd.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:cluster
disabled = false

[monitor:///opt/phantom/var/log/phantom/consul-stderr.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:cluster
disabled = false

[monitor:///opt/phantom/var/log/phantom/consul-stdout.log]
index = splunk_app_soar
sourcetype = splunk_app_soar:cluster
disabled = false


#### SOAR Audit ####

[audit]
start_by_shell = false
python.version = python3
sourcetype = soar
interval = 30
start =
disabled = 0
